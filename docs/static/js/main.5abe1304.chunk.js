(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{130:function(e,n,t){e.exports=t(313)},313:function(e,n,t){"use strict";t.r(n);var a=t(3),r=t(42),i=t(43),l=t(48),o=t(44),c=t(49),u=t(7),s=t.n(u),d=s()()("FONTS.SET_FONTS"),m=s()()("LAYER.ADD_IMAGE_LAYER"),h=s()()("LAYER.ADD_TEXT_LAYER"),p=s()()("LAYER.CHANGE_STYLE"),f=s()()("LAYER.CHANGE_VALUE"),g=s()()("LAYER.DOWN_LAYER"),v=s()()("LAYER.REMOVE_LAYER"),b=s()()("LAYER.SELECT_LAYER"),y=s()()("LAYER.UP_LAYER"),E=s()()("PREVIEW.CHANGE_VALUE"),w=t(0),x=t(16),k=t(4);function j(){var e=Object(a.a)(["\n  height: 100%;\n  width: 100%;\n\n  &:disabled {\n    opacity: 0.5;\n  }\n\n  .icon {\n    color: white;\n    height: 100%;\n    width: 100%;\n  }\n"]);return j=function(){return e},e}var O=k.b.button(j()),C=function(e){return w.createElement(O,e,w.createElement(x.b,{className:"icon"}))};function N(){var e=Object(a.a)(["\n  height: 100%;\n  width: 100%;\n\n  &:disabled {\n    opacity: 0.5;\n  }\n\n  .icon {\n    color: white;\n    height: 100%;\n    width: 100%;\n  }\n"]);return N=function(){return e},e}var L=k.b.button(N()),F=function(e){return w.createElement(L,e,w.createElement(x.a,{className:"icon"}))};function S(){var e=Object(a.a)(["\n  height: 100%;\n  width: 100%;\n\n  .icon {\n    color: white;\n    height: 100%;\n    width: 100%;\n  }\n"]);return S=function(){return e},e}var A=k.b.button(S()),R=function(e){return w.createElement(A,e,w.createElement(x.c,{className:"icon"}))};function I(){var e=Object(a.a)(["\n  height: 100%;\n  width: 100%;\n\n  &:disabled {\n    opacity: 0.5;\n  }\n\n  .icon {\n    color: white;\n    height: 100%;\n    width: 100%;\n  }\n"]);return I=function(){return e},e}var T=k.b.button(I()),Y=function(e){return w.createElement(T,e,w.createElement(x.d,{className:"icon"}))};function z(){var e=Object(a.a)(["\n  height: 100%;\n  width: 100%;\n\n  .icon {\n    color: white;\n    height: 100%;\n    width: 100%;\n  }\n"]);return z=function(){return e},e}var H=k.b.button(z()),P=function(e){return w.createElement(H,e,w.createElement(x.e,{className:"icon"}))};function D(){var e=Object(a.a)(["\n  background-color: #fff;\n  border: 1px #ddd solid;\n\n  &[type='checkbox'] {\n    height: 15px;\n    width: 15px;\n\n    &:checked {\n      background-color: #bbb;\n    }\n  }\n\n  &[type='number'] {\n    text-align: right;\n  }\n"]);return D=function(){return e},e}var W=k.b.input(D()),_=function(e){return w.createElement(W,e)};function M(){var e=Object(a.a)(["\n  dt:not(:first-child) {\n    margin-top: 10px;\n  }\n\n  dd {\n    display: flex;\n    justify-content: flex-end;\n    margin-top: 5px;\n\n    .input {\n      width: 75px;\n    }\n  }\n"]);return M=function(){return e},e}var V=k.b.ul(M()),B=function(e){var n=e.onChange,t=e.opacity,a=e.rotate,r=e.scale;return w.createElement(V,null,w.createElement("dt",null,"opacity"),w.createElement("dd",null,w.createElement(_,{className:"input",max:1,min:0,name:"opacity",onChange:n,step:.1,type:"number",value:t})),w.createElement("dt",null,"rotate"),w.createElement("dd",null,w.createElement(_,{className:"input",name:"rotate",onChange:n,step:.1,type:"number",value:a}),"deg"),w.createElement("dt",null,"scale"),w.createElement("dd",null,w.createElement(_,{className:"input",min:0,name:"scale",onChange:n,step:.01,type:"number",value:r})))};function G(){var e=Object(a.a)(["\n  align-items: center;\n  display: flex;\n\n  dl {\n    align-items: center;\n    display: flex;\n\n    dt:not(:first-child) {\n      margin-left: 10px;\n    }\n\n    dd {\n      align-items: center;\n      display: flex;\n      margin-left: 5px;\n\n      .input {\n        width: 75px;\n      }\n    }\n  }\n"]);return G=function(){return e},e}var U=k.b.div(G()),J=function(e){var n=e.height,t=e.onChange,a=e.overflow,r=e.scale,i=e.width;return w.createElement(U,null,w.createElement("dl",null,w.createElement("dt",null,"width"),w.createElement("dd",null,w.createElement(_,{className:"input",min:0,name:"width",onChange:t,type:"number",value:i}),"px"),w.createElement("dt",null,"height"),w.createElement("dd",null,w.createElement(_,{className:"input",min:0,name:"height",onChange:t,type:"number",value:n}),"px"),w.createElement("dt",null,"scale"),w.createElement("dd",null,w.createElement(_,{className:"input",min:0,name:"scale",onChange:t,step:.1,type:"number",value:r}),"px"),w.createElement("dt",null,"overflow"),w.createElement("dd",null,w.createElement(_,{defaultChecked:a,name:"overflow",onChange:t,type:"checkbox"}))))};function K(){var e=Object(a.a)(["\n  display: grid;\n  grid-gap: 5px;\n  margin-bottom: 5px;\n  width: 100%;\n\n  li {\n    border: 1px solid #ddd;\n    padding: 2.5px;\n\n    &.select {\n      border: solid red 1px;\n    }\n\n    textarea {\n      border: 1px solid #ddd;\n      height: 50px;\n      min-height: 50px;\n      overflow-y: scroll;\n      padding: 2.5px;\n      width: 100%;\n    }\n\n    .image {\n      background-position: center;\n      background-size: cover;\n      height: 50px;\n      overflow: hidden;\n      padding: 2.5px;\n      width: 100%;\n    }\n  }\n"]);return K=function(){return e},e}var X=k.b.ul(K()),q=function(e){var n=e.index,t=e.layers,a=e.onChange,r=e.onClick,i=e.onFocus;return w.createElement(X,null,t.map(function(e,t){var l=w.createElement(w.Fragment,null);if("value"in e){var o=e.value;l=w.createElement("textarea",{"data-index":t,onChange:a,onFocus:i,value:o})}else if("url"in e){var c=e.url;l=w.createElement("div",{className:"image","data-index":t,onClick:r,style:{backgroundImage:"url(".concat(c,")")}})}return w.createElement("li",{className:n===t?"select":"",key:t},l)}).reverse())};function $(){var e=Object(a.a)(["\n  background-color: #bbb;\n  display: grid;\n  grid-auto-rows: 25px;\n  grid-gap: 5px;\n  grid-template-columns: repeat(auto-fill, 25px);\n  padding: 5px;\n  width: 100%;\n\n  li {\n    height: 100%;\n    width: 100%;\n\n    button {\n      height: 100%;\n      width: 100%;\n\n      .icon {\n        color: white;\n        height: 100%;\n        width: 100%;\n      }\n    }\n  }\n"]);return $=function(){return e},e}var Q=k.b.ul($()),Z=function(e){var n=e.children;return w.createElement(Q,null,n.map(function(e,n){return w.createElement("li",{key:n},e)}))},ee=t(8),ne=t(50),te=t(116),ae=function(e){function n(e){var t;return Object(r.a)(this,n),(t=Object(l.a)(this,Object(o.a)(n).call(this,e))).id=void 0,t.id=te(),t.state={height:0,width:0},t}return Object(c.a)(n,e),Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,n=this.props.url,t=new Image;t.onload=function(){var a=t.naturalHeight,r=t.naturalWidth;e.setState({height:a,width:r},function(){var t=document.getElementById(e.id).getContext("2d"),i=new Image;i.src=n,i.onload=function(){t.drawImage(i,0,0,r,a)}})},t.src=n}},{key:"render",value:function(){var e=this.props.style,n=e.rotate,t=e.scale,a=Object(ne.a)(e,["rotate","scale"]),r=this.state,i=r.height,l=r.width;return w.createElement("canvas",{height:i,id:this.id,style:Object(ee.a)({transform:"rotate(".concat(n,"deg) scale(").concat(t,")")},a),width:l})}}]),n}(w.Component),re=t(117),ie=t.n(re);function le(){var e=Object(a.a)(["\n  background-color: #bbb;\n  height: 100%;\n  overflow: scroll;\n  position: relative;\n  width: 100%;\n\n  .wrapper {\n    box-sizing: content-box;\n    left: 0;\n    padding: 50px;\n    position: absolute;\n    top: 0;\n    transform-origin: top left;\n\n    #test {\n      height: inherit;\n      width: inherit;\n\n      .screen {\n        background-color: white;\n        height: inherit;\n        position: relative;\n        width: inherit;\n\n        .draggable {\n          cursor: move;\n          position: absolute;\n          word-break: keep-all;\n        }\n      }\n    }\n  }\n"]);return le=function(){return e},e}var oe=k.b.div(le()),ce=function(e){var n=e.layers,t=e.preview,a=t.height,r=t.overflow,i=t.scale,l=t.width,o=n.map(function(e,n){var t=[];if("value"in e){var a=e.style,r=a.color,l=r.a,o=r.b,c=r.g,u=r.r,s=a.fontFamily.value,d=a.fontSize,m=a.lineHeight,h=a.rotate,p=Object(ne.a)(a,["color","fontFamily","fontSize","lineHeight","rotate"]);e.value.split(/\r\n|\r|\n/).forEach(function(e,n){t.push(w.createElement("div",{key:n,style:Object(ee.a)({fontFamily:s,color:"rgba(".concat(u,", ").concat(c,", ").concat(o,", ").concat(l,")"),fontSize:"".concat(d,"px"),height:"".concat(m,"px"),lineHeight:"".concat(m,"px"),transform:"rotate(".concat(h,"deg)")},p)},e))})}else if("url"in e){var f=e.style,g=e.url;t.push(w.createElement(ae,{key:g,style:f,url:g}))}return w.createElement(ie.a,{className:"draggable",key:n,parentScale:i},t)});return w.createElement(oe,{id:"preview"},w.createElement("div",{className:"wrapper",style:{height:"".concat(a,"px"),transform:"scale(".concat(i,")"),width:"".concat(l,"px")}},w.createElement("div",{id:"test"},w.createElement("div",{className:"screen",style:{overflow:r?"visible":"hidden"}},o))))},ue=t(118),se=t(119);function de(){var e=Object(a.a)(["\n  dt:not(:first-child) {\n    margin-top: 10px;\n  }\n\n  dd {\n    display: flex;\n    justify-content: flex-end;\n    margin-top: 5px;\n\n    .select {\n      width: 200px;\n    }\n\n    .input {\n      width: 75px;\n    }\n\n    .picker .chrome-picker {\n      background-color: #fff;\n      border: 1px #ddd solid;\n      border-radius: 0 !important;\n      box-shadow: none !important;\n      font-family: inherit !important;\n\n      > div {\n        border-radius: 0 !important;\n      }\n    }\n  }\n"]);return de=function(){return e},e}var me=k.b.ul(de()),he=function(e){var n=e.color,t=e.fontFamily,a=e.fonts,r=e.fontSize,i=e.fontWeight,l=e.lineHeight,o=e.onChange,c=e.onChangeColor,u=e.onChangeFontFamily,s=e.opacity,d=e.rotate;return w.createElement(me,null,w.createElement("dt",null,"color"),w.createElement("dd",null,w.createElement("div",{className:"picker"},w.createElement(ue.ChromePicker,{color:n,onChange:c}))),w.createElement("dt",null,"font-family"),w.createElement("dd",null,w.createElement(se.a,{className:"select",onChange:u,options:a.map(function(e){var n=e.fontFamily;return{label:e.name,value:n}}),value:t})),w.createElement("dt",null,"font-size"),w.createElement("dd",null,w.createElement(_,{className:"input",min:0,name:"fontSize",onChange:o,type:"number",value:r}),"px"),w.createElement("dt",null,"font-weight"),w.createElement("dd",null,w.createElement(_,{className:"input",max:900,min:100,name:"fontWeight",onChange:o,step:100,type:"number",value:i})),w.createElement("dt",null,"line-height"),w.createElement("dd",null,w.createElement(_,{className:"input",min:0,name:"lineHeight",onChange:o,type:"number",value:l}),"px"),w.createElement("dt",null,"opacity"),w.createElement("dd",null,w.createElement(_,{className:"input",max:1,min:0,name:"opacity",onChange:o,step:.1,type:"number",value:s})),w.createElement("dt",null,"rotate"),w.createElement("dd",null,w.createElement(_,{className:"input",name:"rotate",onChange:o,step:.1,type:"number",value:d}),"deg"))},pe=t(129);function fe(){var e=Object(a.a)(["\n  background-color: rgba(255, 255, 255, 0.75);\n  height: 100%;\n  left: 0;\n  position: fixed;\n  top: 0;\n  width: 100%;\n  z-index: 9999;\n\n  .wrapper {\n    align-items: center;\n    cursor: pointer;\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    justify-content: center;\n    width: 100%;\n\n    img {\n      height: calc(231px / 3);\n      opacity: 0.75;\n      width: calc(289px / 3);\n    }\n\n    p {\n      margin-top: 15px;\n    }\n  }\n"]);return fe=function(){return e},e}var ge=k.b.div(fe()),ve=function(e){var n=e.onDrop;return w.createElement(ge,null,w.createElement(pe.a,{accept:"image/*",onDrop:n},function(e){var n=e.getRootProps,t=e.getInputProps,a=e.isDragActive;return w.createElement("div",Object.assign({},n(),{className:"wrapper"}),w.createElement("input",t()),w.createElement("img",{src:"/images/dd.png"}),w.createElement("p",null,a?"Drop files here...":"Try dropping some image files here, or click to select files to upload."))}))},be=t(123),ye=t.n(be),Ee=t(124),we=t(14),xe=t(47),ke=t(126);function je(){var e=Object(a.a)(["\n  background-color: #fbfbfb;\n  display: grid;\n  height: 100%;\n  grid-template-columns: 275px 1fr 200px;\n  grid-template-rows: 25px 1fr;\n\n  .header {\n    border-bottom: 1px #ddd inset;\n    grid-column: 1 / 4;\n  }\n\n  .detail {\n    overflow-y: scroll;\n    padding: 5px;\n  }\n\n  .preview {\n    box-shadow: 1px 0px #ddd inset;\n    display: grid;\n    grid-gap: 5px;\n    grid-template-rows: 1fr 20px;\n    padding: 5px;\n  }\n\n  .side-layers {\n    box-shadow: 1px 0px #ddd inset;\n    display: flex;\n    flex-direction: column;\n\n    .layers {\n      flex-basis: 0;\n      flex-grow: 1;\n      overflow-y: scroll;\n      padding: 5px;\n    }\n  }\n"]);return je=function(){return e},e}var Oe=k.b.div(je()),Ce=function(e){function n(e){var t;return Object(r.a)(this,n),(t=Object(l.a)(this,Object(o.a)(n).call(this,e))).rootEl=void 0,t.rootEl=document.getElementById("root"),t.state={isShowPortal:!1},t}return Object(c.a)(n,e),Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.setFonts,n=new XMLHttpRequest;n.open("GET","/jsons/fonts.json",!0),n.responseType="blob",n.onload=function(n){var t=n.target.response,a=new FileReader;a.onload=function(n){var t=n.target.result,a=JSON.parse(t);e(a),ke.load({custom:{families:a.map(function(e){return e.fontFamily}),urls:["/css/fonts.css"]}})},a.readAsText(t)},n.send()}},{key:"componentDidUpdate",value:function(e){var n=e.layers,t=this.props.layers;n.length!==t.length&&this.setState({isShowPortal:!1})}},{key:"render",value:function(){var e=this,n=this.props,t=n.addImageLayers,a=n.addTextLayer,r=n.changeColor,i=n.changeFontFamily,l=n.changePreviewValue,o=n.changeStyle,c=n.changeValue,u=n.downLayer,s=n.fonts,d=n.index,m=n.layers,h=n.preview,p=n.removeLayer,f=n.selectLayer,g=n.upLayer,v=this.state.isShowPortal,b=w.createElement(w.Fragment,null);if(void 0!==d){var y=m[d];if("value"in y){var E=y.style;b=w.createElement(he,Object.assign({},E,{fonts:s,onChange:o,onChangeColor:r,onChangeFontFamily:i}))}else if("url"in y){var x=y.style;b=w.createElement(B,Object.assign({},x,{onChange:o}))}}return w.createElement(Oe,null,w.createElement("header",{className:"header"},w.createElement("button",{onClick:function(){ye.a.toBlob(document.getElementById("test")).then(function(e){Object(Ee.saveAs)(e,"test.png")})}},"save")),w.createElement("aside",{className:"detail"},b),w.createElement("div",{className:"preview"},w.createElement(ce,{layers:m,preview:h}),w.createElement(J,Object.assign({},h,{onChange:l}))),w.createElement("aside",{className:"side-layers"},w.createElement(Z,null,[w.createElement(R,{key:"add",onClick:a}),w.createElement(Y,{disabled:void 0===d,key:"delete",onClick:p}),w.createElement(P,{key:"image",onClick:function(){e.setState({isShowPortal:!0})}}),w.createElement(C,{disabled:void 0===d||d===m.length-1,key:"up",onClick:g}),w.createElement(F,{disabled:!d,key:"down",onClick:u})]),w.createElement("div",{className:"layers"},w.createElement(q,{index:d,layers:m,onChange:c,onClick:f,onFocus:f}))),v?we.createPortal(w.createElement(ve,{onDrop:t}),this.rootEl):"")}}]),n}(w.Component),Ne=Object(xe.b)(function(e){var n=e.fonts.fonts,t=e.layer;return{fonts:n,index:t.index,layers:t.layers,preview:e.preview}},function(e){return{addImageLayers:function(n){n.forEach(function(n){e(m({url:URL.createObjectURL(n)}))})},addTextLayer:function(){return e(h())},changeColor:function(n){var t=n.rgb;return e(p({value:t,name:"color"}))},changeFontFamily:function(n){return e(p({value:n,name:"fontFamily"}))},changePreviewValue:function(n){var t=n.currentTarget,a=t.checked,r=t.name,i=t.type,l=t.value;return e(E({name:r,value:"checkbox"===i?a:l}))},changeStyle:function(n){var t=n.currentTarget,a=t.name,r=t.value;return e(p({name:a,value:r}))},changeValue:function(n){var t=n.target.value;return e(f({value:t}))},downLayer:function(){return e(g())},removeLayer:function(){return e(v())},selectLayer:function(n){var t=n.currentTarget.dataset;return e(b({index:parseInt(t.index,10)}))},setFonts:function(n){return e(d({fonts:n}))},upLayer:function(){return e(y())}}})(Ce),Le=t(23);t(311),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Fe=t(24),Se=Object(Fe.reducerWithInitialState)({fonts:[]}).case(d,function(e,n){var t=n.fonts;return Object(ee.a)({},e,{fonts:t})}),Ae={index:void 0,layers:[]},Re=Object(Fe.reducerWithInitialState)(Ae).case(m,function(e,n){var t=n.url,a=e.layers.slice();return a.push({url:t,style:{opacity:1,rotate:0,scale:1}}),Object(ee.a)({},e,{layers:a})}).case(h,function(e){var n=e.layers.slice();return n.push({style:{color:{a:1,b:0,g:0,r:0},fontFamily:{label:"\u6a5f\u68b0\u5f6b\u523b\u7528\u6a19\u6e96\u66f8\u4f53 M",value:"KikaiChokokuJIS-Md"},fontSize:16,fontWeight:400,lineHeight:16,opacity:1,rotate:0},value:""}),Object(ee.a)({},e,{layers:n})}).case(p,function(e,n){var t=n.name,a=n.value,r=e.index,i=e.layers.slice();return i[r].style[t]="fontSize"===t||"fontWeight"===t||"lineHeight"===t?parseInt(a,10):"opacity"===t||"rotate"===t||"scale"===t?parseFloat(a):a,Object(ee.a)({},e,{layers:i})}).case(f,function(e,n){var t=n.value,a=e.index,r=e.layers.slice(),i=r[a];return"value"in i&&(i.value=t,r[a]=i),Object(ee.a)({},e,{layers:r})}).case(g,function(e){var n=e.index,t=e.layers.slice(),a=t[n];return t[n]=t[n-1],t[n-1]=a,Object(ee.a)({},e,{layers:t})}).case(v,function(e){var n=e.index,t=e.layers;if(void 0===n)return e;var a=t.slice();return a.splice(n,1),{layers:a,index:void 0}}).case(b,function(e,n){var t=n.index;return Object(ee.a)({},e,{index:t})}).case(y,function(e){var n=e.index,t=e.layers.slice(),a=t[n];return t[n]=t[n+1],t[n+1]=a,Object(ee.a)({},e,{layers:t})}),Ie=t(46),Te=Object(Fe.reducerWithInitialState)({height:300,overflow:!0,scale:1,width:400}).case(E,function(e,n){var t,a=n.name,r=n.value;return t="height"===a||"width"===a?parseInt(r,10):"scale"===a?parseFloat(r):r,Object(ee.a)({},e,Object(Ie.a)({},a,t))}),Ye=function(){return Object(Le.b)({fonts:Se,layer:Re,preview:Te})};function ze(){var e=Object(a.a)(['\n  html {\n    font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", YuGothic, "\u30d2\u30e9\u30ae\u30ce\u89d2\u30b4 ProN W3", Hiragino Kaku Gothic ProN, Arial, "\u30e1\u30a4\u30ea\u30aa", Meiryo, sans-serif;\n    font-size: 62.5%;\n    -moz-osx-font-smoothing: grayscale;\n    -webkit-font-smoothing: antialiased;\n    font-style: normal;\n    font-weight: 400;\n    height: 100%;\n    line-height: 1.2;\n    overflow: hidden !important;\n    -webkit-overflow-scrolling: touch;\n    width: 100%;\n  \n    body {\n      font-size: 1.4rem;\n      height: 100%;\n      width: 100%;\n    \n      #root {\n        height: 100%;\n        width: 100%;\n\n        * {\n          appearance: none;\n          \n          &:focus {\n            outline: none;\n          }\n        }\n  \n        a {\n          line-height: 0;\n        }\n\n        ul {\n          list-style: none;\n        }\n      }\n    }\n  }\n']);return ze=function(){return e},e}var He=Object(Le.c)(Ye()),Pe=Object(k.a)(ze());we.render(w.createElement(xe.a,{store:He},w.createElement(Ne,null),w.createElement(Pe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[130,2,1]]]);
//# sourceMappingURL=main.5abe1304.chunk.js.map